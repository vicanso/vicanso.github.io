---
sidebar_position: 88
title: é™æ€æ–‡ä»¶æœåŠ¡ (Directory)
description: å°† Pingap ä½œä¸ºä¸€ä¸ªé«˜æ€§èƒ½çš„é™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼Œç”¨äºæ‰˜ç®¡ç½‘ç«™ã€æ–‡æ¡£æˆ–å‰ç«¯å•é¡µé¢åº”ç”¨ (SPA)ã€‚æ”¯æŒç›®å½•æµè§ˆã€ç¼“å­˜æ§åˆ¶å’Œå¼ºåˆ¶ä¸‹è½½ç­‰å¤šç§åŠŸèƒ½ã€‚
---

# é™æ€æ–‡ä»¶æœåŠ¡ (Directory) æ’ä»¶

`directory` æ’ä»¶å¯ä»¥å°† `Pingap` çš„ä¸€ä¸ª `Location` è½¬å˜ä¸ºä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„é™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼Œç›´æ¥ä»ç£ç›˜æä¾›æ–‡ä»¶æœåŠ¡ï¼Œè€Œæ— éœ€å°†è¯·æ±‚è½¬å‘åˆ°ä¸Šæ¸¸åç«¯ã€‚



## åŠŸèƒ½ç®€ä»‹

æ­¤æ’ä»¶æ‹¦æˆªåŒ¹é…çš„è¯·æ±‚ï¼Œå¹¶å°†å…¶æ˜ å°„åˆ°æœåŠ¡å™¨ä¸Šçš„ä¸€ä¸ªæŒ‡å®šç›®å½•ã€‚å®ƒå…·å¤‡äº†ç”Ÿäº§çº§é™æ€æ–‡ä»¶æœåŠ¡å™¨æ‰€éœ€çš„å„é¡¹æ ¸å¿ƒåŠŸèƒ½ï¼š

* **æ–‡ä»¶ä¸ç›®å½•æœåŠ¡**ï¼šç›´æ¥æä¾›æ–‡ä»¶å†…å®¹ï¼Œæˆ–åœ¨è¯·æ±‚ç›®å½•æ—¶è‡ªåŠ¨æŸ¥æ‰¾ç´¢å¼•æ–‡ä»¶ï¼ˆå¦‚ `index.html`ï¼‰ã€‚
* **ç›®å½•æµè§ˆ (Auto Index)**ï¼šå¦‚æœæ‰¾ä¸åˆ°ç´¢å¼•æ–‡ä»¶ï¼Œå¯ä»¥è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç±»ä¼¼ Apache çš„æ–‡ä»¶åˆ—è¡¨é¡µé¢ï¼Œæ–¹ä¾¿æµè§ˆç›®å½•å†…å®¹ã€‚
* **MIME ç±»å‹è¯†åˆ«**ï¼šæ ¹æ®æ–‡ä»¶æ‰©å±•åï¼Œè‡ªåŠ¨è®¾ç½®æ­£ç¡®çš„ `Content-Type` å“åº”å¤´ã€‚
* **ç¼“å­˜æ§åˆ¶**ï¼šæ”¯æŒ `ETag` å’Œ `Cache-Control` (max-age) å“åº”å¤´ï¼Œä»¥å……åˆ†åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜ã€‚
* **å¤§æ–‡ä»¶æµå¼ä¼ è¾“**ï¼šå¯¹äºå¤§æ–‡ä»¶ï¼Œæ’ä»¶ä¼šä»¥åˆ†å—(chunked)çš„æ–¹å¼æµå¼ä¼ è¾“ï¼Œå‡å°‘å†…å­˜å ç”¨ã€‚
* **å¼ºåˆ¶ä¸‹è½½**ï¼šå¯ä»¥é…ç½®ä¸ºå¼ºåˆ¶æµè§ˆå™¨ä¸‹è½½æ–‡ä»¶ï¼Œè€Œä¸æ˜¯åœ¨æµè§ˆå™¨å†…ç›´æ¥æ‰“å¼€ã€‚

## ä½¿ç”¨åœºæ™¯

* **æ‰˜ç®¡å•é¡µé¢åº”ç”¨ (SPA)**ï¼šä½¿ç”¨æ­¤æ’ä»¶ä½œä¸ºæ‚¨ React, Vue æˆ– Angular åº”ç”¨çš„ Web æœåŠ¡å™¨ï¼Œæä¾› `index.html` å’Œæ‰“åŒ…åçš„ JS/CSS æ–‡ä»¶ã€‚
* **æ­å»ºæ–‡æ¡£ç«™ç‚¹**ï¼šä¸ºæ‚¨çš„é¡¹ç›®æˆ–äº§å“æä¾›é™æ€ç”Ÿæˆçš„ HTML æ–‡æ¡£ã€‚
* **æä¾›å¯ä¸‹è½½æ–‡ä»¶**ï¼šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ä»“åº“ï¼Œè®©ç”¨æˆ·å¯ä»¥æµè§ˆå’Œä¸‹è½½è½¯ä»¶åŒ…ã€æ–‡æ¡£æˆ–å…¶ä»–èµ„æºã€‚
* **å¿«é€Ÿæ­å»ºæœ¬åœ°å¼€å‘æœåŠ¡å™¨**ï¼šåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¿«é€Ÿå¯åŠ¨ä¸€ä¸ªæœ¬åœ° Web æœåŠ¡å™¨æ¥é¢„è§ˆé™æ€é¡µé¢ã€‚

## é…ç½®å‚æ•°

åœ¨ `plugins.directory.toml` æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®ã€‚

| å‚æ•°         | ç±»å‹             | æ˜¯å¦å¿…éœ€ | é»˜è®¤å€¼         | è¯´æ˜                                                                                                                             |
| :----------- | :--------------- | :------- | :------------- | :------------------------------------------------------------------------------------------------------------------------------- |
| `path`       | String           | **æ˜¯**   | -              | **ï¼ˆå¿…éœ€ï¼‰** æŒ‡å®šè¦æä¾›æœåŠ¡çš„æ ¹ç›®å½•åœ¨æœåŠ¡å™¨ä¸Šçš„ç‰©ç†è·¯å¾„ã€‚æ”¯æŒç»å¯¹è·¯å¾„ (å¦‚ `/var/www/html`) æˆ–ç›¸å¯¹è·¯å¾„ (ç›¸å¯¹äº Pingap è¿è¡Œç›®å½•)ã€‚ |
| `index`      | String           | å¦       | `"index.html"` | å½“è¯·æ±‚çš„ URL æ˜¯ä¸€ä¸ªç›®å½•æ—¶ï¼Œè‡ªåŠ¨æŸ¥æ‰¾å¹¶æä¾›çš„é»˜è®¤æ–‡ä»¶åã€‚                                                                          |
| `autoindex`  | Boolean          | å¦       | `false`        | å¦‚æœè¯·æ±‚çš„æ˜¯ä¸€ä¸ªç›®å½•ä¸”æ‰¾ä¸åˆ° `index` æ–‡ä»¶ï¼Œæ˜¯å¦è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå¯æµè§ˆçš„æ–‡ä»¶åˆ—è¡¨é¡µé¢ã€‚                                                |
| `download`   | Boolean          | å¦       | `false`        | æ˜¯å¦ä¸ºæ‰€æœ‰æ–‡ä»¶æ·»åŠ  `Content-Disposition: attachment` å¤´ï¼Œå¼ºåˆ¶æµè§ˆå™¨å¼¹å‡ºä¸‹è½½å¯¹è¯æ¡†ã€‚                                              |
| `max_age`    | String           | å¦       | *(ç©º)*         | è®¾ç½® `Cache-Control: max-age` çš„å€¼ï¼Œæ§åˆ¶æµè§ˆå™¨ç¼“å­˜é™æ€èµ„æºçš„æ—¶é—´ã€‚æ ¼å¼ä¸ºæ—¶é—´å­—ç¬¦ä¸²ï¼ˆå¦‚ `"10m"`, `"24h"`ï¼‰ã€‚                      |
| `private`    | Boolean          | å¦       | `false`        | å¦‚æœè®¾ç½®ï¼Œ`Cache-Control` å¤´ä¸­ä¼šåŠ å…¥ `private` æŒ‡ä»¤ï¼Œé˜²æ­¢ CDN ç­‰å…±äº«ç¼“å­˜ç¼“å­˜èµ„æºã€‚                                               |
| `headers`    | Array of Strings | å¦       | `[]`           | ä¸ºæ‰€æœ‰å“åº”æ·»åŠ ä¸€ç»„è‡ªå®šä¹‰çš„ HTTP å“åº”å¤´ã€‚                                                                                         |
| `charset`    | String           | å¦       | *(ç©º)*         | ä¸º `text/*` ç±»å‹çš„ Mime-Type å“åº”å¤´æ·»åŠ å­—ç¬¦é›†ï¼Œä¾‹å¦‚ `utf-8`ã€‚                                                                    |
| `chunk_size` | String           | å¦       | `"4KiB"`       | æµå¼ä¼ è¾“å¤§æ–‡ä»¶æ—¶ï¼Œæ¯ä¸ªæ•°æ®å—çš„å¤§å°ï¼Œä¾‹å¦‚ `"1MB"`ã€‚                                                                               |

---

## å®Œæ•´ç¤ºä¾‹

**ç›®æ ‡**ï¼šä½¿ç”¨ Pingap æ‰˜ç®¡ä¸€ä¸ªå•é¡µé¢åº”ç”¨ (SPA)ï¼Œå¹¶ä¸º `/assets` ç›®å½•ä¸‹çš„èµ„æºè®¾ç½®é•¿æ—¶é—´çš„æµè§ˆå™¨ç¼“å­˜ã€‚

1.  **é…ç½®æ’ä»¶ (`plugins.static-spa.toml`)**:
    ```toml
    # æŒ‡å®šåº”ç”¨çš„æ ¹ç›®å½•
    path = "/var/www/my-app"

    # å½“è®¿é—® / æ—¶ï¼Œæä¾› index.html æ–‡ä»¶
    index = "index.html"
    
    # ä¸ºæ‰€æœ‰é™æ€èµ„æºè®¾ç½® 1 å¤©çš„æµè§ˆå™¨ç¼“å­˜
    max_age = "24h"
    
    # ç¦ç”¨ç›®å½•æµè§ˆåŠŸèƒ½ï¼Œå¢åŠ å®‰å…¨æ€§
    autoindex = false
    
    # ä¸º text/html, text/css, application/javascript ç­‰æ–‡ä»¶æ·»åŠ  utf-8 å­—ç¬¦é›†
    charset = "utf-8"
    ```

2.  **åœ¨ Location ä¸­åº”ç”¨æ’ä»¶ (`location.toml`)**:
    > ğŸ’¡ **æç¤º**ï¼šç”±äºé™æ€æ–‡ä»¶æœåŠ¡æ’ä»¶é€šå¸¸ä¼šç›´æ¥å“åº”è¯·æ±‚ï¼Œå®ƒåº”è¯¥è¢«æ”¾ç½®åœ¨ä¸€ä¸ªç‹¬ç«‹çš„ `Location` ä¸­ï¼Œå¹¶ä¸”è¯¥ `Location` **ä¸åº”**é…ç½® `upstream`ã€‚

    ```toml
    # ...
    [locations.route-for-my-app]
    # åŒ¹é…æ‰€æœ‰è¯·æ±‚
    path = "/"
    # æ³¨æ„ï¼šè¿™é‡Œæ²¡æœ‰ upstream
    plugins = [
        "static-spa",
    ]
    # ...
    ```

### è®¿é—®æ•ˆæœ

* å½“ç”¨æˆ·è®¿é—® `http://your-domain.com/` æ—¶ï¼š
    * æ’ä»¶ä¼šåŒ¹é…åˆ°æ ¹è·¯å¾„ `/`ã€‚
    * å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªç›®å½•ï¼Œæ’ä»¶ä¼šè‡ªåŠ¨æŸ¥æ‰¾å¹¶æä¾› `index` å‚æ•°æŒ‡å®šçš„æ–‡ä»¶ï¼Œå³ `/var/www/my-app/index.html`ã€‚
    * å“åº”å¤´ä¸­ä¼šåŒ…å« `Content-Type: text/html; charset=utf-8`ã€‚

* å½“æµè§ˆå™¨è¯·æ±‚ `http://your-domain.com/assets/app.js` æ—¶ï¼š
    * æ’ä»¶ä¼šå°† URL è·¯å¾„æ˜ å°„åˆ°ç‰©ç†æ–‡ä»¶ `/var/www/my-app/assets/app.js`ã€‚
    * å“åº”å¤´ä¸­ä¼šåŒ…å« `Content-Type: application/javascript; charset=utf-8` ä»¥åŠ `Cache-Control: max-age=86400`ï¼Œå‘Šè¯‰æµè§ˆå™¨å¯ä»¥å°†è¿™ä¸ªæ–‡ä»¶ç¼“å­˜ 24 å°æ—¶ã€‚

* å½“ç”¨æˆ·è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯å¾„ï¼Œå¦‚ `http://your-domain.com/non-existent-page` æ—¶ï¼š
    * æ’ä»¶åœ¨ç£ç›˜ä¸Šæ‰¾ä¸åˆ°å¯¹åº”çš„æ–‡ä»¶ï¼Œä¼šè¿”å›ä¸€ä¸ªæ ‡å‡†çš„ `404 Not Found` å“åº”ã€‚