<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-plugins/referer-restriction" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Referer Restriction | Pingap</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://vicanso.github.io/pingap-en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://vicanso.github.io/pingap-en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://vicanso.github.io/pingap-en/docs/plugins/referer-restriction"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Referer Restriction | Pingap"><meta data-rh="true" name="description" content="Implement access control based on the request&#x27;s origin by checking the HTTP Referer header. Effectively prevent hotlinking of resources like images and videos, and restrict API calls to trusted websites."><meta data-rh="true" property="og:description" content="Implement access control based on the request&#x27;s origin by checking the HTTP Referer header. Effectively prevent hotlinking of resources like images and videos, and restrict API calls to trusted websites."><link data-rh="true" rel="icon" href="/pingap-en/img/pingap.png"><link data-rh="true" rel="canonical" href="https://vicanso.github.io/pingap-en/docs/plugins/referer-restriction"><link data-rh="true" rel="alternate" href="https://vicanso.github.io/pingap-en/docs/plugins/referer-restriction" hreflang="en"><link data-rh="true" rel="alternate" href="https://vicanso.github.io/pingap-en/docs/plugins/referer-restriction" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://QJ6H7139JP-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Plugin Overview and Index","item":"https://vicanso.github.io/pingap-en/docs/plugins/"},{"@type":"ListItem","position":2,"name":"Referer Restriction","item":"https://vicanso.github.io/pingap-en/docs/plugins/referer-restriction"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="Pingap" href="/pingap-en/opensearch.xml"><link rel="stylesheet" href="/pingap-en/assets/css/styles.975a7111.css">
<script src="/pingap-en/assets/js/runtime~main.4dc9c26d.js" defer="defer"></script>
<script src="/pingap-en/assets/js/main.4bdbaeda.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/pingap-en/"><div class="navbar__logo"><img src="/pingap-en/img/pingap.png" alt="Pingap Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/pingap-en/img/pingap.png" alt="Pingap Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Pingap</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/pingap-en/docs/introduction">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="http://pingap.io/pingap-zh/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">中文<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/vicanso/pingap" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/introduction">What is Pingap?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/getting_started">Getting Started Tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/argument">Command-Line Arguments and Environment Variables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/config">Detailed Configuration Reference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/log">Access Log Formatting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/certificate">Easily Manage HTTPS Certificates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/plugin">Plugin System</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/pingap-en/docs/plugins/">Plugin Overview and Index</a><button aria-label="Collapse sidebar category &#x27;Plugin Overview and Index&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/accept-encoding">Accept Encoding Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/basic-auth">Basic Auth</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/cache">Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/combined-auth">Combined Auth</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/compression">Response Compression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/cors">Cross-Origin Resource Sharing (CORS)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/csrf">CSRF Protection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/directory">Static File Service (Directory)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/ip-restriction">IP Restriction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/jwt">JWT Authentication (JWT)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/key-auth">API Key Auth</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/limit">Rate Limit</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/mock">Mock Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/ping">Health Check (Ping)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/redirect">HTTP Redirect</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/pingap-en/docs/plugins/referer-restriction">Referer Restriction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/request-id">Request ID</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/response-headers">Response Headers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/sub-filter">Content Substitution (Sub Filter)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/traffic-splitting">Traffic Splitting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pingap-en/docs/plugins/ua-restriction">User-Agent Restriction</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/docker">Deploying Pingap with Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/question">Frequently Asked Questions (FAQ)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/performance">性能测试</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/pingap-en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/pingap-en/docs/plugins/"><span>Plugin Overview and Index</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Referer Restriction</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Referer Restriction Plugin</h1></header>
<p>The <code>referer-restriction</code> plugin is a request-phase security plugin that inspects the HTTP <code>Referer</code> request header to identify the origin page of a request, and then <strong>allows</strong> or <strong>denies</strong> the request based on a list of rules you configure.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="feature-introduction">Feature Introduction<a href="#feature-introduction" class="hash-link" aria-label="Direct link to Feature Introduction" title="Direct link to Feature Introduction">​</a></h2>
<p>When a browser requests a resource (e.g., an image) from your service from a page (e.g., <code>https://example.com/page</code>), it typically includes a <code>Referer</code> header with the value <code>https://example.com/page</code>. This plugin leverages this mechanism to implement access control.</p>
<p>It supports two core working modes:</p>
<ol>
<li><strong>Whitelist (Allow)</strong>: Only allows requests whose <code>Referer</code> is in your specified list to pass through.</li>
<li><strong>Blacklist (Deny)</strong>: Denies requests whose <code>Referer</code> is in your specified list.</li>
</ol>
<p>The matching rules support both <strong>exact domains</strong> (e.g., <code>example.com</code>) and <strong>wildcard domains</strong> (e.g., <code>*.example.com</code>), providing flexible configuration options.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases">Use Cases<a href="#use-cases" class="hash-link" aria-label="Direct link to Use Cases" title="Direct link to Use Cases">​</a></h2>
<ul>
<li><strong>Preventing Resource Hotlinking</strong>: This is the most classic use case. You can configure a <strong>whitelist</strong> to only allow <code>Referer</code>s from your own website to load static assets like images, videos, and fonts. This prevents other websites from directly using your resources and consuming your server&#x27;s bandwidth.</li>
<li><strong>Enhancing API Security</strong>: Configure a <strong>whitelist</strong> for your Web API to only allow calls from the domain where your official frontend application is hosted. This adds an extra layer of security by blocking direct API calls from other unknown websites.</li>
<li><strong>Blocking Malicious or Spam Sources</strong>: If you find that spam websites or malicious crawlers are accessing your service by forging <code>Referer</code>s, you can add their domains to a <strong>blacklist</strong>.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration-parameters">Configuration Parameters<a href="#configuration-parameters" class="hash-link" aria-label="Direct link to Configuration Parameters" title="Direct link to Configuration Parameters">​</a></h2>
<p>Configuration is done in the <code>plugin.referer-restriction.toml</code> file.</p>
<table><thead><tr><th style="text-align:left">Parameter</th><th style="text-align:left">Type</th><th style="text-align:left">Required</th><th style="text-align:left">Default</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left"><code>type</code></td><td style="text-align:left">String</td><td style="text-align:left"><strong>Yes</strong></td><td style="text-align:left">-</td><td style="text-align:left"><strong>(Required)</strong> The type of restriction. Possible values are <code>&quot;deny&quot;</code> (blacklist mode) or <code>&quot;allow&quot;</code> (whitelist mode).</td></tr><tr><td style="text-align:left"><code>referer_list</code></td><td style="text-align:left">Array of Strings</td><td style="text-align:left"><strong>Yes</strong></td><td style="text-align:left"><code>[]</code></td><td style="text-align:left"><strong>(Required)</strong> A list used to match against the domain in the <code>Referer</code> header. Two formats are supported:<br>• <strong>Exact match</strong>: <code>&quot;site.com&quot;</code><br>• <strong>Wildcard match</strong>: <code>&quot;*.site.com&quot;</code></td></tr><tr><td style="text-align:left"><code>message</code></td><td style="text-align:left">String</td><td style="text-align:left">No</td><td style="text-align:left"><code>&quot;Request is forbidden&quot;</code></td><td style="text-align:left">A custom message to return to the client when a request is denied.</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="complete-examples">Complete Examples<a href="#complete-examples" class="hash-link" aria-label="Direct link to Complete Examples" title="Direct link to Complete Examples">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-1-preventing-image-hotlinking-whitelist-mode">Example 1: Preventing Image Hotlinking (Whitelist Mode)<a href="#example-1-preventing-image-hotlinking-whitelist-mode" class="hash-link" aria-label="Direct link to Example 1: Preventing Image Hotlinking (Whitelist Mode)" title="Direct link to Example 1: Preventing Image Hotlinking (Whitelist Mode)">​</a></h3>
<p><strong>Goal</strong>: Our website domain is <code>my-gallery.com</code>, and we only want images in the <code>/images/</code> directory to be referenced by our own website (including all subdomains).</p>
<ol>
<li>
<p><strong>Configure the plugin (<code>plugin.referer-allow-images.toml</code>)</strong>:</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Set to whitelist mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type = &quot;allow&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Only allow requests from my-gallery.com and all its subdomains</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">referer_list = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;my-gallery.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;*.my-gallery.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Apply the plugin in a Location (<code>location.toml</code>)</strong>:</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># location.toml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[locations.image-assets]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Only apply to the images directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">path = &quot;/images/&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This Location is handled by a static file plugin or an upstream service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">upstream = &quot;static-assets-backend&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plugins = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;referer-allow-images&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="access-effects">Access Effects<a href="#access-effects" class="hash-link" aria-label="Direct link to Access Effects" title="Direct link to Access Effects">​</a></h3>
<ul>
<li>When the page <code>https://my-gallery.com/index.html</code> loads the image <code>/images/cat.jpg</code>, the request&#x27;s <code>Referer</code> is <code>https://my-gallery.com/index.html</code>, which matches the whitelist. <strong>Access is granted</strong>.</li>
<li>When the page <code>https://evil-site.com/steal.html</code> tries to reference <code>/images/cat.jpg</code> using an <code>&lt;img&gt;</code> tag, the request&#x27;s <code>Referer</code> is <code>https://evil-site.com/steal.html</code>, which does not match the whitelist. The request will be intercepted and a <strong><code>403 Forbidden</code></strong> will be returned.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-2-blocking-known-spam-sources-blacklist-mode">Example 2: Blocking Known Spam Sources (Blacklist Mode)<a href="#example-2-blocking-known-spam-sources-blacklist-mode" class="hash-link" aria-label="Direct link to Example 2: Blocking Known Spam Sources (Blacklist Mode)" title="Direct link to Example 2: Blocking Known Spam Sources (Blacklist Mode)">​</a></h3>
<p><strong>Goal</strong>: Block all access from <code>spam-domain.com</code> and <code>bad-site.org</code>.</p>
<ol>
<li>
<p><strong>Configure the plugin (<code>plugin.referer-deny-spam.toml</code>)</strong>:</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Set to blacklist mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type = &quot;deny&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># List the domains to block</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">referer_list = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;spam-domain.com&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;bad-site.org&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>Apply the plugin in a Location (<code>location.toml</code>)</strong>:</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># location.toml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[locations.main-site]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">path = &quot;/&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">upstream = &quot;main-server&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plugins = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;referer-deny-spam&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ... other plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="access-effects-1">Access Effects<a href="#access-effects-1" class="hash-link" aria-label="Direct link to Access Effects" title="Direct link to Access Effects">​</a></h3>
<ul>
<li>Any request with a <code>Referer</code> header pointing to <code>spam-domain.com</code> or <code>bad-site.org</code> will be intercepted and will receive a <strong><code>403 Forbidden</code></strong>.</li>
<li>Requests from other sources (like a Google search results page) will pass through normally.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="precautions">Precautions<a href="#precautions" class="hash-link" aria-label="Direct link to Precautions" title="Direct link to Precautions">​</a></h2>
<ul>
<li>❗ <strong>Security Warning</strong>: The <code>Referer</code> header is sent by the client (browser) and therefore <strong>can be forged</strong>. Please do not use Referer restriction as your <strong>only</strong> security mechanism to protect critical or sensitive operations. It is better suited as a supplementary line of defense to increase the difficulty for attackers.</li>
<li><strong>Empty Referer</strong>: The <code>Referer</code> header may be empty when a user types a URL directly into the browser&#x27;s address bar, or when navigating from an HTTPS page to an HTTP page. In this plugin:<!-- -->
<ul>
<li><strong>Whitelist mode (<code>allow</code>)</strong>: Requests with an empty <code>Referer</code> <strong>will be denied</strong> because they do not match any allowed domains.</li>
<li><strong>Blacklist mode (<code>deny</code>)</strong>: Requests with an empty <code>Referer</code> <strong>will be allowed</strong> because they do not match any forbidden domains.</li>
</ul>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/plugins/referer-restriction.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/pingap-en/docs/plugins/redirect"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">HTTP Redirect</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/pingap-en/docs/plugins/request-id"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Request ID</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#feature-introduction" class="table-of-contents__link toc-highlight">Feature Introduction</a></li><li><a href="#use-cases" class="table-of-contents__link toc-highlight">Use Cases</a></li><li><a href="#configuration-parameters" class="table-of-contents__link toc-highlight">Configuration Parameters</a></li><li><a href="#complete-examples" class="table-of-contents__link toc-highlight">Complete Examples</a><ul><li><a href="#example-1-preventing-image-hotlinking-whitelist-mode" class="table-of-contents__link toc-highlight">Example 1: Preventing Image Hotlinking (Whitelist Mode)</a></li><li><a href="#access-effects" class="table-of-contents__link toc-highlight">Access Effects</a></li><li><a href="#example-2-blocking-known-spam-sources-blacklist-mode" class="table-of-contents__link toc-highlight">Example 2: Blocking Known Spam Sources (Blacklist Mode)</a></li><li><a href="#access-effects-1" class="table-of-contents__link toc-highlight">Access Effects</a></li></ul></li><li><a href="#precautions" class="table-of-contents__link toc-highlight">Precautions</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024-2025 Tree Xie.</div></div></div></footer></div>
</body>
</html>