<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-config" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Configuration Guide | Pingap</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://vicanso.github.io/pingap-en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://vicanso.github.io/pingap-en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://vicanso.github.io/pingap-en/docs/config"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Configuration Guide | Pingap"><meta data-rh="true" name="description" content="Pingap uses TOML for parameter configuration. For time-related configurations, use formats like 1s, 1m, 1h. For storage size configurations, use formats like 1kb, 1mb, 1gb. Detailed parameter descriptions are as follows:"><meta data-rh="true" property="og:description" content="Pingap uses TOML for parameter configuration. For time-related configurations, use formats like 1s, 1m, 1h. For storage size configurations, use formats like 1kb, 1mb, 1gb. Detailed parameter descriptions are as follows:"><link data-rh="true" rel="icon" href="/pingap-en/img/pingap.png"><link data-rh="true" rel="canonical" href="https://vicanso.github.io/pingap-en/docs/config"><link data-rh="true" rel="alternate" href="https://vicanso.github.io/pingap-en/docs/config" hreflang="en"><link data-rh="true" rel="alternate" href="https://vicanso.github.io/pingap-en/docs/config" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://QJ6H7139JP-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Configuration Guide","item":"https://vicanso.github.io/pingap-en/docs/config"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="Pingap" href="/pingap-en/opensearch.xml"><link rel="stylesheet" href="/pingap-en/assets/css/styles.975a7111.css">
<script src="/pingap-en/assets/js/runtime~main.a821fb53.js" defer="defer"></script>
<script src="/pingap-en/assets/js/main.61715bf6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/pingap-en/"><div class="navbar__logo"><img src="/pingap-en/img/pingap.png" alt="Pingap Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/pingap-en/img/pingap.png" alt="Pingap Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Pingap</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/pingap-en/docs/introduction">Documentation</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="http://pingap.io/pingap-zh/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">中文<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/vicanso/pingap" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/introduction">Pingap Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/getting_started">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/argument">Command Line Arguments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/pingap-en/docs/config">Configuration Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/log">Log Formatting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/certificate">HTTPS Certificate Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/plugin">Plugin System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/docker">Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/question">Frequently Asked Questions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/pingap-en/docs/performance">Performance Testing</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/pingap-en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Configuration Guide</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Configuration Guide</h1></header>
<p>Pingap uses TOML for parameter configuration. For time-related configurations, use formats like <code>1s</code>, <code>1m</code>, <code>1h</code>. For storage size configurations, use formats like <code>1kb</code>, <code>1mb</code>, <code>1gb</code>. Detailed parameter descriptions are as follows:</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-configuration">Basic Configuration<a href="#basic-configuration" class="hash-link" aria-label="Direct link to Basic Configuration" title="Direct link to Basic Configuration">​</a></h2>
<ul>
<li><code>name</code>: Instance name, defaults to <code>Pingap</code>. If deploying multiple instances on the same machine, configure different names</li>
<li><code>error_template</code>: Optional parameter for HTML template used when errors occur. You can customize the error HTML template. When an error occurs, <code>{{version}}</code> will be replaced with the Pingap version, and <code>{{content}}</code> with specific error information</li>
<li><code>pid_file</code>: Optional parameter, defaults to <code>/run/pingap.pid</code>. Configures the process ID record file path. For multiple instances on one machine, configure different paths</li>
<li><code>upgrade_sock</code>: Optional parameter, defaults to <code>/tmp/pingap_upgrade.sock</code>. Configures the socket path for zero-downtime updates, used when switching between old and new Pingap processes. For multiple instances, configure different paths</li>
<li><code>user</code>: Optional parameter, defaults to empty. Sets the daemon process execution user</li>
<li><code>group</code>: Optional parameter, defaults to empty, similar to <code>user</code></li>
<li><code>threads</code>: Optional parameter, defaults to 1. Sets thread count for each service (like server TCP connections). If set to 0, uses CPU core count or cgroup core limit</li>
<li><code>work_stealing</code>: Optional parameter, defaults to <code>true</code>. Enables work stealing between different threads within the same service</li>
<li><code>grace_period</code>: Sets graceful exit waiting period, defaults to 5 minutes</li>
<li><code>graceful_shutdown_timeout</code>: Sets graceful shutdown timeout, defaults to 5 seconds</li>
<li><code>upstream_keepalive_pool_size</code>: Sets upstream connection pool size, defaults to <code>128</code></li>
<li><code>webhook</code>: Webhook request path</li>
<li><code>webhook_type</code>: Webhook type, supports regular HTTP, <code>webcom</code>, and <code>dingtalk</code></li>
<li><code>webhook_notifications</code>: Webhook notification types, including <code>backend_status</code>, <code>lets_encrypt</code>, <code>diff_config</code>, <code>restart</code>, <code>restart_fail</code>, and <code>tls_validity</code></li>
<li><code>log_level</code>: Application log output level, defaults to <code>INFO</code></li>
<li><code>log_buffered_size</code>: Log buffer size, defaults to 0. If set below 4096, no buffer is used</li>
<li><code>log_format_json</code>: Sets JSON formatted logging</li>
<li><code>sentry</code>: Sentry DSN configuration, requires <code>full feature</code> version</li>
<li><code>pyroscope</code>: Pyroscope connection address(<code>http://ip:port?app=pingap&amp;tag:a=A&amp;tag:b=B</code>), requires perf version as default version doesn&#x27;t include pyroscope support</li>
<li><code>auto_restart_check_interval</code>: Configuration update check interval, defaults to 90 seconds. If set below 1 second, checks are disabled</li>
<li><code>cache_directory</code>: Sets cache directory. When set, uses file-based caching. File cache periodically removes long-unused files. Format: <code>/opt/pingap/cache?reading_max=1000&amp;writing_max=500&amp;cache_max=200&amp;cache_file_max_weight=256</code>
<ul>
<li><code>reading_max</code>: Maximum concurrent cache reads (file cache only)</li>
<li><code>writing_max</code>: Maximum concurrent cache writes (file cache only)</li>
<li><code>cache_max</code>: Hot data cache limit in file cache, uses tinyufo for memory cache, defaults to 100. Set to 0 to disable memory hot cache</li>
<li><code>cache_file_max_weight</code>: Maximum cache file weight for tinyufo, defaults to 256, which means 256 * 4096 bytes, files larger than this value will not be cached to tinyufo</li>
</ul>
</li>
<li><code>cache_max_size</code>: Maximum cache space limit, shared by all services. Not applicable to file cache</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upstream">Upstream<a href="#upstream" class="hash-link" aria-label="Direct link to Upstream" title="Direct link to Upstream">​</a></h2>
<p>Upstream configuration defines backend service node lists. For domain configurations, the system adds all node addresses based on DNS resolution results (automatic DNS updates require configured service discovery). HTTP health checks are recommended for node status monitoring.</p>
<p>Main parameters:</p>
<ul>
<li><code>addrs</code>: Node address list, format: <code>ip:port [weight]</code>, weight is optional (defaults to 1)</li>
<li><code>discovery</code>: Service discovery method. DNS recommended for domains, docker label for docker services</li>
<li><code>update_frequency</code>: Service discovery update interval, recommended for dynamic node updates</li>
<li><code>algo</code>: Node selection algorithm, supports <code>hash</code> and <code>round_robin</code>. Example: <code>hash:ip</code> selects nodes by IP hash. Defaults to <code>round_robin</code></li>
<li><code>sni</code>: Required SNI for HTTPS configurations</li>
<li><code>verify_cert</code>: Certificate validation requirement for HTTPS</li>
<li><code>health_check</code>: Node health check configuration, supports HTTP, TCP, and gRPC</li>
<li><code>ipv4_only</code>: For domain configurations, restricts to IPv4 nodes only</li>
<li><code>enable_tracer</code>: Enables tracer functionality for upstream connection tracking</li>
<li><code>alpn</code>: ALPN configuration for TLS handshake, defaults to H1</li>
<li><code>connection_timeout</code>: TCP connection timeout, default none</li>
<li><code>total_connection_timeout</code>: Connection timeout including TLS handshake for HTTPS, default none</li>
<li><code>read_timeout</code>: Read timeout, default none</li>
<li><code>idle_timeout</code>: Idle timeout for connection recycling. Set to 0 for no connection reuse. Default none</li>
<li><code>write_timeout</code>: Write timeout, default none</li>
<li><code>tcp_idle</code>: TCP keepalive idle timeout</li>
<li><code>tcp_interval</code>: TCP keepalive check interval</li>
<li><code>tcp_probe_count</code>: TCP keepalive probe count</li>
<li><code>tcp_recv_buf</code>: TCP receive buffer size</li>
<li><code>tcp_fast_open</code>: Enable tcp fast open for upstream</li>
</ul>
<p>Note: All three parameters (<code>tcp_idle</code>, <code>tcp_interval</code>, <code>tcp_probe_count</code>) must be set for TCP keepalive.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="health-check-configuration">Health Check Configuration<a href="#health-check-configuration" class="hash-link" aria-label="Direct link to Health Check Configuration" title="Direct link to Health Check Configuration">​</a></h3>
<p>Supports three health check methods:</p>
<ul>
<li><code>HTTP(S)</code>: <code>http://upstream-name/check-path?parameters</code></li>
<li><code>TCP</code>: <code>tcp://upstream-name?parameters</code></li>
<li><code>gRPC</code>: <code>grpc://upstream-name?service=service-name&amp;parameters</code></li>
</ul>
<p>Common parameters:</p>
<ul>
<li><code>connection_timeout</code>: Connection timeout, default 3 seconds</li>
<li><code>read_timeout</code>: Read timeout, default 3 seconds</li>
<li><code>check_frequency</code>: Check interval, default 10 seconds</li>
<li><code>success</code>: Consecutive successes needed for healthy status, default 1</li>
<li><code>failure</code>: Consecutive failures needed for unhealthy status, default 2</li>
<li><code>reuse</code>: Connection reuse option, default false</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hash-algorithm-options">Hash Algorithm Options<a href="#hash-algorithm-options" class="hash-link" aria-label="Direct link to Hash Algorithm Options" title="Direct link to Hash Algorithm Options">​</a></h3>
<p>When using hash for upstream backend selection:</p>
<ul>
<li><code>hash:url</code>: URL-based forwarding for URL-cached services</li>
<li><code>hash:ip</code>: IP-based forwarding for IP-persistent data services</li>
<li><code>hash:header:X-User</code>: Forward based on <code>X-User</code> header value</li>
<li><code>hash:cookie:uid</code>: Forward based on <code>uid</code> cookie value</li>
<li><code>hash:query:appKey</code>: Forward based on <code>appkey</code> query parameter</li>
<li><code>hash:path</code>: Path-based forwarding (default hash method)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="location">Location<a href="#location" class="hash-link" aria-label="Direct link to Location" title="Direct link to Location">​</a></h2>
<p>Location configures request matching rules, header insertion, and plugin associations. Key parameters:</p>
<ul>
<li><code>upstream</code>: Associated upstream configuration. Optional if all processing is handled by plugins</li>
<li><code>path</code>: Matching path, detailed usage below</li>
<li><code>host</code>: Matching domain(s), comma-separated for multiple. Use <code>~</code> prefix for regex</li>
<li><code>proxy_set_headers</code>: Request headers to set/override when forwarding to upstream</li>
<li><code>proxy_add_headers</code>: Request headers to add when forwarding to upstream</li>
<li><code>rewrite</code>: Path rewrite rules</li>
<li><code>weight</code>: Custom weight for location priority</li>
<li><code>plugins</code>: Ordered plugin list for this location</li>
<li><code>client_max_body_size</code>: Maximum client request body size</li>
<li><code>max_processing</code>: Maximum concurrent request limit (0 for unlimited)</li>
<li><code>grpc_web</code>: Enable grpc-web support</li>
<li><code>enable_reverse_proxy_headers</code>: Whether to enable reverse proxy request headers. When enabled, the following headers will be added:<!-- -->
<ul>
<li><code>X-Real-IP</code>: Indicates the client&#x27;s IP address</li>
<li><code>X-Forwarded-For</code>: Indicates proxy addresses, added according to x-forwarded-for format</li>
<li><code>X-Forwarded-Proto</code>: Indicates the request scheme, such as http or https</li>
<li><code>X-Forwarded-Host</code>: Indicates the request host</li>
<li><code>X-Forwarded-Port</code>: Indicates the server port</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="path-matching-rules">Path Matching Rules<a href="#path-matching-rules" class="hash-link" aria-label="Direct link to Path Matching Rules" title="Direct link to Path Matching Rules">​</a></h3>
<p>Location paths support these rules (highest to lowest priority):</p>
<ul>
<li>Exact match: Prefix with <code>=</code>, e.g., <code>=/api</code> matches exact <code>/api</code> path</li>
<li>Regex match: Prefix with <code>~</code>, e.g., <code>~^/(api|rest)</code> matches paths starting with <code>/api</code> or <code>/rest</code></li>
<li>Prefix match: e.g., <code>/api</code> matches paths starting with <code>/api</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="path-rewrite-rules">Path Rewrite Rules<a href="#path-rewrite-rules" class="hash-link" aria-label="Direct link to Path Rewrite Rules" title="Direct link to Path Rewrite Rules">​</a></h3>
<p>Supports regex-based path rewriting (similar to nginx). One rule per configuration. Examples:</p>
<ul>
<li><code>^/api/ /</code>: Replaces <code>/api/</code> prefix with <code>/</code></li>
<li><code>^/(\S*?)/ /api/$1/</code>: Adds <code>/api</code> prefix</li>
<li><code>^/(\S*?)/api/(\S*?) /$1/$2</code>: Removes <code>/api</code> from path</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="supported-header-variables">Supported Header Variables<a href="#supported-header-variables" class="hash-link" aria-label="Direct link to Supported Header Variables" title="Direct link to Supported Header Variables">​</a></h3>
<ul>
<li><code>$hostname</code>: Host machine hostname</li>
<li><code>$host</code>: Request host</li>
<li><code>$scheme</code>: Request scheme (http/https)</li>
<li><code>$remote_addr</code>: Client address</li>
<li><code>$remote_port</code>: Client port</li>
<li><code>$server_addr</code>: Server address</li>
<li><code>$server_port</code>: Server port</li>
<li><code>$proxy_add_x_forwarded_for</code>: Proxy addresses in x-forwarded-for format</li>
<li><code>$upstream_addr</code>: Upstream address</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="server">Server<a href="#server" class="hash-link" aria-label="Direct link to Server" title="Direct link to Server">​</a></h2>
<ul>
<li><code>server.x</code>: Server configuration where <code>x</code> is unique server name</li>
<li><code>addr</code>: Listening address(es) in <code>ip:port</code> format, comma-separated for multiple</li>
<li><code>access_log</code>: Optional, disabled by default. Supports formats: <code>combined</code>, <code>common</code>, <code>short</code>, <code>tiny</code></li>
<li><code>locations</code>: Location list for this server</li>
<li><code>threads</code>: Default thread count, 0 for CPU core count, default 1</li>
<li><code>tls_cipher_list</code>: Pre-TLS 1.3 cipher suites</li>
<li><code>tls_ciphersuites</code>: TLS 1.3 cipher suites</li>
<li><code>tls_min_version</code>: Minimum TLS version, default 1.2</li>
<li><code>tls_max_version</code>: Maximum TLS version, default 1.3</li>
<li><code>global_certificates</code>: Enable global certificates for unmatched server names</li>
<li><code>enabled_h2</code>: Enable HTTP/2 (recommended, uses h2c for HTTP)</li>
<li><code>tcp_idle</code>: TCP keepalive idle timeout</li>
<li><code>tcp_interval</code>: TCP keepalive check interval</li>
<li><code>tcp_probe_count</code>: TCP keepalive probe count</li>
<li><code>tcp_fastopen</code>: Enable TCP fast open with backlog size</li>
<li><code>prometheus_metrics</code>: Enable Prometheus metrics (full features version only)</li>
<li><code>otlp_exporter</code>: OpenTelemetry collector address (full features version only)</li>
<li><code>modules</code>: Enable specific modules (required for web-grpc)</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/config.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/pingap-en/docs/argument"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Command Line Arguments</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/pingap-en/docs/log"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Log Formatting</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#basic-configuration" class="table-of-contents__link toc-highlight">Basic Configuration</a></li><li><a href="#upstream" class="table-of-contents__link toc-highlight">Upstream</a><ul><li><a href="#health-check-configuration" class="table-of-contents__link toc-highlight">Health Check Configuration</a></li><li><a href="#hash-algorithm-options" class="table-of-contents__link toc-highlight">Hash Algorithm Options</a></li></ul></li><li><a href="#location" class="table-of-contents__link toc-highlight">Location</a><ul><li><a href="#path-matching-rules" class="table-of-contents__link toc-highlight">Path Matching Rules</a></li><li><a href="#path-rewrite-rules" class="table-of-contents__link toc-highlight">Path Rewrite Rules</a></li><li><a href="#supported-header-variables" class="table-of-contents__link toc-highlight">Supported Header Variables</a></li></ul></li><li><a href="#server" class="table-of-contents__link toc-highlight">Server</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024-2025 Tree Xie.</div></div></div></footer></div>
</body>
</html>