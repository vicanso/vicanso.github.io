"use strict";(self.webpackChunkpingap=self.webpackChunkpingap||[]).push([[6990],{9837:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"plugins/directory","title":"Static File Service (Directory)","description":"Use Pingap as a high-performance static file server to host websites, documentation, or frontend Single Page Applications (SPAs). Supports features like directory listing, cache control, and forced downloads.","source":"@site/docs/plugins/directory.md","sourceDirName":"plugins","slug":"/plugins/directory","permalink":"/pingap-en/docs/plugins/directory","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/plugins/directory.md","tags":[],"version":"current","sidebarPosition":88,"frontMatter":{"sidebar_position":88,"title":"Static File Service (Directory)","description":"Use Pingap as a high-performance static file server to host websites, documentation, or frontend Single Page Applications (SPAs). Supports features like directory listing, cache control, and forced downloads."},"sidebar":"tutorialSidebar","previous":{"title":"CSRF Protection","permalink":"/pingap-en/docs/plugins/csrf"},"next":{"title":"IP Restriction","permalink":"/pingap-en/docs/plugins/ip-restriction"}}');var i=n(4848),l=n(8453);const r={sidebar_position:88,title:"Static File Service (Directory)",description:"Use Pingap as a high-performance static file server to host websites, documentation, or frontend Single Page Applications (SPAs). Supports features like directory listing, cache control, and forced downloads."},c="Static File Service (Directory) Plugin",d={},o=[{value:"Feature Introduction",id:"feature-introduction",level:2},{value:"Use Cases",id:"use-cases",level:2},{value:"Configuration Parameters",id:"configuration-parameters",level:2},{value:"Complete Example",id:"complete-example",level:2},{value:"Access Effects",id:"access-effects",level:3}];function a(e){const t={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"static-file-service-directory-plugin",children:"Static File Service (Directory) Plugin"})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"directory"})," plugin can transform a ",(0,i.jsx)(t.code,{children:"Location"})," in ",(0,i.jsx)(t.code,{children:"Pingap"})," into a powerful static file server, serving files directly from the disk without forwarding requests to an upstream backend."]}),"\n",(0,i.jsx)(t.h2,{id:"feature-introduction",children:"Feature Introduction"}),"\n",(0,i.jsx)(t.p,{children:"This plugin intercepts matching requests and maps them to a specified directory on the server. It includes all the core functionalities required for a production-grade static file server:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"File and Directory Serving"}),": Directly serves file content, or automatically looks for an index file (like ",(0,i.jsx)(t.code,{children:"index.html"}),") when a directory is requested."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Directory Listing (Auto Index)"}),": If no index file is found, it can automatically generate an Apache-style file listing page, making it easy to browse directory contents."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"MIME Type Recognition"}),": Automatically sets the correct ",(0,i.jsx)(t.code,{children:"Content-Type"})," response header based on the file extension."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Cache Control"}),": Supports ",(0,i.jsx)(t.code,{children:"ETag"})," and ",(0,i.jsx)(t.code,{children:"Cache-Control"})," (max-age) response headers to fully leverage browser caching."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Large File Streaming"}),": For large files, the plugin streams them in chunks, reducing memory usage."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Forced Download"}),": Can be configured to force the browser to download files instead of opening them directly."]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Hosting Single Page Applications (SPAs)"}),": Use this plugin as the web server for your React, Vue, or Angular applications, serving ",(0,i.jsx)(t.code,{children:"index.html"})," and the bundled JS/CSS files."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Building Documentation Sites"}),": Serve statically generated HTML documentation for your projects or products."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Providing Downloadable Files"}),": Create a file repository where users can browse and download software packages, documents, or other resources."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Quickly Setting Up a Local Development Server"}),": During development, quickly start a local web server to preview static pages."]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"configuration-parameters",children:"Configuration Parameters"}),"\n",(0,i.jsxs)(t.p,{children:["Configuration is done in the ",(0,i.jsx)(t.code,{children:"plugin.directory.toml"})," file."]}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Required"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Default"}),(0,i.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"path"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"String"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.strong,{children:"Yes"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"-"}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,i.jsx)(t.strong,{children:"(Required)"})," Specifies the physical path of the root directory to be served on the server. Supports absolute paths (e.g., ",(0,i.jsx)(t.code,{children:"/var/www/html"}),") or relative paths (relative to the Pingap running directory)."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"index"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"String"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"No"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:'"index.html"'})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"The default filename to look for and serve when the requested URL is a directory."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"autoindex"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Boolean"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"No"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"false"})}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["If a directory is requested and the ",(0,i.jsx)(t.code,{children:"index"})," file is not found, whether to automatically generate a browsable file listing page."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"download"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Boolean"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"No"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"false"})}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["Whether to add the ",(0,i.jsx)(t.code,{children:"Content-Disposition: attachment"})," header for all files, forcing the browser to open a download dialog."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"max_age"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"String"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"No"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.em,{children:"(empty)"})}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["Sets the value for ",(0,i.jsx)(t.code,{children:"Cache-Control: max-age"}),", controlling how long browsers should cache static assets. The format is a time string (e.g., ",(0,i.jsx)(t.code,{children:'"10m"'}),", ",(0,i.jsx)(t.code,{children:'"24h"'}),")."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"private"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Boolean"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"No"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"false"})}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["If set, the ",(0,i.jsx)(t.code,{children:"private"})," directive will be added to the ",(0,i.jsx)(t.code,{children:"Cache-Control"})," header, preventing shared caches like CDNs from caching the resource."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"headers"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Array of Strings"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"No"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"[]"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"Adds a set of custom HTTP response headers to all responses."})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"charset"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"String"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"No"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.em,{children:"(empty)"})}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["Adds a character set to the Mime-Type response header for ",(0,i.jsx)(t.code,{children:"text/*"})," types, for example, ",(0,i.jsx)(t.code,{children:"utf-8"}),"."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:"chunk_size"})}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"String"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:"No"}),(0,i.jsx)(t.td,{style:{textAlign:"left"},children:(0,i.jsx)(t.code,{children:'"4KiB"'})}),(0,i.jsxs)(t.td,{style:{textAlign:"left"},children:["The size of each data chunk when streaming large files, for example, ",(0,i.jsx)(t.code,{children:'"1MB"'}),"."]})]})]})]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Goal"}),": Host a Single Page Application (SPA) using Pingap and set a long browser cache duration for assets under the ",(0,i.jsx)(t.code,{children:"/assets"})," directory."]}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsxs)(t.strong,{children:["Configure the plugin (",(0,i.jsx)(t.code,{children:"plugin.static-spa.toml"}),")"]}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-toml",children:'# Specify the root directory of the application\npath = "/var/www/my-app"\n\n# Serve the index.html file when / is accessed\nindex = "index.html"\n\n# Set a 1-day browser cache for all static assets\nmax_age = "24h"\n\n# Disable directory listing for better security\nautoindex = false\n\n# Add utf-8 charset for files like text/html, text/css, application/javascript\ncharset = "utf-8"\n'})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsxs)(t.strong,{children:["Apply the plugin in a Location (",(0,i.jsx)(t.code,{children:"location.toml"}),")"]}),":"]}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsxs)(t.p,{children:["\ud83d\udca1 ",(0,i.jsx)(t.strong,{children:"Tip"}),": Since the static file service plugin usually responds to requests directly, it should be placed in a separate ",(0,i.jsx)(t.code,{children:"Location"})," that does ",(0,i.jsx)(t.strong,{children:"not"})," have an ",(0,i.jsx)(t.code,{children:"upstream"})," configured."]}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-toml",children:'# ...\n[locations.route-for-my-app]\n# Match all requests\npath = "/"\n# Note: no upstream here\nplugins = [\n    "static-spa",\n]\n# ...\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"access-effects",children:"Access Effects"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["When a user visits ",(0,i.jsx)(t.code,{children:"http://your-domain.com/"}),":"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["The plugin will match the root path ",(0,i.jsx)(t.code,{children:"/"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["Since it's a directory, the plugin will automatically find and serve the file specified by the ",(0,i.jsx)(t.code,{children:"index"})," parameter, which is ",(0,i.jsx)(t.code,{children:"/var/www/my-app/index.html"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["The response header will include ",(0,i.jsx)(t.code,{children:"Content-Type: text/html; charset=utf-8"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["When the browser requests ",(0,i.jsx)(t.code,{children:"http://your-domain.com/assets/app.js"}),":"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["The plugin will map the URL path to the physical file ",(0,i.jsx)(t.code,{children:"/var/www/my-app/assets/app.js"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["The response header will include ",(0,i.jsx)(t.code,{children:"Content-Type: application/javascript; charset=utf-8"})," and ",(0,i.jsx)(t.code,{children:"Cache-Control: max-age=86400"}),", telling the browser it can cache this file for 24 hours."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["When a user visits a non-existent path, like ",(0,i.jsx)(t.code,{children:"http://your-domain.com/non-existent-page"}),":"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["The plugin will not find the corresponding file on the disk and will return a standard ",(0,i.jsx)(t.code,{children:"404 Not Found"})," response."]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,l.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>c});var s=n(6540);const i={},l=s.createContext(i);function r(e){const t=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(l.Provider,{value:t},e.children)}}}]);