"use strict";(self.webpackChunkpingap=self.webpackChunkpingap||[]).push([[3624],{6496:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>o,contentTitle:()=>i,default:()=>l,frontMatter:()=>c,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"performance","title":"Performance Testing","description":"Performance testing is a complex process with scenarios that heavily rely on various configurations, thus the following are only simple test scenarios.","source":"@site/docs/performance.md","sourceDirName":".","slug":"/performance","permalink":"/pingap-en/docs/performance","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/performance.md","tags":[],"version":"current","sidebarPosition":161,"frontMatter":{"sidebar_position":161},"sidebar":"tutorialSidebar","previous":{"title":"Frequently Asked Questions (FAQ)","permalink":"/pingap-en/docs/question"}}');var a=s(4848),r=s(8453);const c={sidebar_position:161},i="Performance Testing",o={},d=[{value:"Nginx\uff08No access log\uff09",id:"nginxno-access-log",level:3},{value:"Pingap forwarding to nginx",id:"pingap-forwarding-to-nginx",level:3},{value:"Pingap responding with 230KB CSS",id:"pingap-responding-with-230kb-css",level:3},{value:"Compression",id:"compression",level:3},{value:"Caching",id:"caching",level:3}];function p(n){const e={code:"code",h1:"h1",h3:"h3",header:"header",p:"p",pre:"pre",...(0,r.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"performance-testing",children:"Performance Testing"})}),"\n",(0,a.jsx)(e.p,{children:"Performance testing is a complex process with scenarios that heavily rely on various configurations, thus the following are only simple test scenarios."}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"Architecture:     x86_64 \nCPU op-mode(s):   32-bit, 64-bit\nByte Order:       Little Endian\nCPU(s):           16       \nOn-line CPU(s) list: 0-15\nThread(s) per core: 2        \nModel name:       Intel(R) Core(TM) i5-13400 @ 4.60GHz \nL3 cache:         20 MiB  \n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'ulimit -n 65536\nsudo sysctl -w net.core.somaxconn=65535\nsudo sysctl -w net.ipv4.tcp_tw_reuse=1\nsudo sysctl -w net.ipv4.ip_local_port_range="1024 65535"\n'})}),"\n",(0,a.jsx)(e.h3,{id:"nginxno-access-log",children:"Nginx\uff08No access log\uff09"}),"\n",(0,a.jsx)(e.p,{children:"Nginx is used only for comparison."}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"wrk -c 1000 -t 10 'http://127.0.0.1:8080/api/json' --latency\nRunning 10s test @ http://127.0.0.1:8080/api/json\n  10 threads and 1000 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    15.97ms   63.05ms   1.02s    95.53%\n    Req/Sec    20.22k     1.62k   27.58k    90.20%\n  Latency Distribution\n     50%    4.66ms\n     75%    4.72ms\n     90%    4.81ms\n     99%  336.44ms\n  2011820 requests in 10.03s, 640.82MB read\n  Socket errors: connect 0, read 2986, write 0, timeout 0\nRequests/sec: 200591.12\nTransfer/sec:     63.89MB\n"})}),"\n",(0,a.jsx)(e.h3,{id:"pingap-forwarding-to-nginx",children:"Pingap forwarding to nginx"}),"\n",(0,a.jsx)(e.p,{children:"Threads: 1"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"wrk -c 1000 -t 10 --latency http://127.0.0.1:8090/api/test\nRunning 10s test @ http://127.0.0.1:8090/api/test\n  10 threads and 1000 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    38.75ms   51.25ms 193.70ms   79.22%\n    Req/Sec    14.16k     1.91k   20.05k    71.10%\n  Latency Distribution\n     50%    1.79ms\n     75%   75.46ms\n     90%  127.35ms\n     99%  161.89ms\n  1408545 requests in 10.02s, 374.78MB read\nRequests/sec: 140565.72\nTransfer/sec:     37.40MB\n"})}),"\n",(0,a.jsx)(e.p,{children:"Threads: 2"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"wrk -c 1000 -t 10 --latency http://127.0.0.1:8090/api/test\nRunning 10s test @ http://127.0.0.1:8090/api/test\n  10 threads and 1000 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency     8.63ms   10.23ms  69.29ms   80.18%\n    Req/Sec    23.66k     1.44k   26.51k    87.40%\n  Latency Distribution\n     50%    1.72ms\n     75%   15.59ms\n     90%   25.36ms\n     99%   36.10ms\n  2354115 requests in 10.03s, 626.37MB read\nRequests/sec: 234789.28\nTransfer/sec:     62.47MB\n"})}),"\n",(0,a.jsx)(e.p,{children:"Threads: 3"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"wrk -c 1000 -t 10 --latency http://127.0.0.1:8090/api/test\nRunning 10s test @ http://127.0.0.1:8090/api/test\n  10 threads and 1000 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency     3.97ms    3.91ms  43.27ms   81.21%\n    Req/Sec    32.74k     1.13k   35.76k    87.20%\n  Latency Distribution\n     50%    1.64ms\n     75%    6.51ms\n     90%    9.81ms\n     99%   15.25ms\n  3257197 requests in 10.02s, 866.66MB read\nRequests/sec: 324922.79\nTransfer/sec:     86.45MB\n"})}),"\n",(0,a.jsx)(e.p,{children:"Threads: 4"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"wrk -c 1000 -t 10 --latency http://127.0.0.1:8090/api/test\nRunning 10s test @ http://127.0.0.1:8090/api/test\n  10 threads and 1000 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency     2.92ms    2.49ms  24.68ms   78.64%\n    Req/Sec    39.91k   813.08    42.53k    69.60%\n  Latency Distribution\n     50%    1.71ms\n     75%    4.55ms\n     90%    6.64ms\n     99%   10.23ms\n  3970942 requests in 10.02s, 1.03GB read\nRequests/sec: 396274.98\nTransfer/sec:    105.44MB\n"})}),"\n",(0,a.jsx)(e.h3,{id:"pingap-responding-with-230kb-css",children:"Pingap responding with 230KB CSS"}),"\n",(0,a.jsx)(e.p,{children:"Threads: 4"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"wrk -c 1000 -t 10 --latency http://127.0.0.1:8090/bootstrap.min.css\nRunning 10s test @ http://127.0.0.1:8090/bootstrap.min.css\n  10 threads and 1000 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency    67.17ms   34.21ms   1.09s    70.01%\n    Req/Sec   744.58    263.37     1.35k    63.00%\n  Latency Distribution\n     50%   64.98ms\n     75%   90.87ms\n     90%  105.10ms\n     99%  124.30ms\n  74121 requests in 10.02s, 16.05GB read\n  Non-2xx or 3xx responses: 198\nRequests/sec:   7393.88\nTransfer/sec:      1.60GB\n"})}),"\n",(0,a.jsx)(e.h3,{id:"compression",children:"Compression"}),"\n",(0,a.jsx)(e.p,{children:"Testing the processing performance when the client supports various compression formats. The compression levels used are: gzip(6), br(6), zstd(6). Actual usage should be set as needed. Pingap is set to 4 threads for all cases."}),"\n",(0,a.jsx)(e.p,{children:"Client supports gzip compression (Response data 30.2KB)"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'wrk -c 1000 -t 10 --latency -H "accept-encoding: gzip" http://127.0.0.1:8090/bootstrap.min.css\nRunning 10s test @ http://127.0.0.1:8090/bootstrap.min.css\n  10 threads and 1000 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   306.29ms  124.46ms   1.33s    56.06%\n    Req/Sec   160.07     76.51   660.00     74.57%\n  Latency Distribution\n     50%  310.72ms\n     75%  418.42ms\n     90%  468.79ms\n     99%  525.62ms\n  15948 requests in 10.02s, 468.26MB read\nRequests/sec:   1591.26\nTransfer/sec:     46.72MB\n'})}),"\n",(0,a.jsx)(e.p,{children:"Client supports br compression (Response data 26.8KB)"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'wrk -c 1000 -t 10 --latency -H "accept-encoding: br" http://127.0.0.1:8090/bootstrap.min.css\nRunning 10s test @ http://127.0.0.1:8090/bootstrap.min.css\n  10 threads and 1000 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   481.04ms  188.25ms   1.63s    68.02%\n    Req/Sec   102.31     52.41   610.00     84.20%\n  Latency Distribution\n     50%  479.02ms\n     75%  630.50ms\n     90%  727.51ms\n     99%  825.87ms\n  10058 requests in 10.02s, 254.64MB read\nRequests/sec:   1003.75\nTransfer/sec:     25.41MB\n'})}),"\n",(0,a.jsx)(e.p,{children:"Client supports zstd compression (Response data 29.0KB)"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'wrk -c 1000 -t 10 --latency -H "accept-encoding: zstd" http://127.0.0.1:8090/bootstrap.min.css\nRunning 10s test @ http://127.0.0.1:8090/bootstrap.min.css\n  10 threads and 1000 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency   295.13ms  129.33ms   1.45s    66.63%\n    Req/Sec   166.25     53.38   510.00     76.48%\n  Latency Distribution\n     50%  284.72ms\n     75%  391.32ms\n     90%  466.32ms\n     99%  574.70ms\n  16562 requests in 10.03s, 464.94MB read\nRequests/sec:   1651.31\nTransfer/sec:     46.36MB\n'})}),"\n",(0,a.jsx)(e.h3,{id:"caching",children:"Caching"}),"\n",(0,a.jsx)(e.p,{children:"Using the caching plugin, data is cached by compression type. Since compression is only executed on the first access, all compression methods heavily utilize resources on first access. Pingap is set to 4 threads for all cases."}),"\n",(0,a.jsx)(e.p,{children:"The following test results show that with the same 4-thread setting, Requests/sec increased from 1651 to 160583, nearly a hundred-fold improvement."}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'wrk -c 1000 -t 10 --latency -H "accept-encoding: zstd" http://127.0.0.1:8090/bootstrap.min.css\nRunning 10s test @ http://127.0.0.1:8090/bootstrap.min.css\n  10 threads and 1000 connections\n  Thread Stats   Avg      Stdev     Max   +/- Stdev\n    Latency     6.42ms    4.55ms  32.84ms   69.08%\n    Req/Sec    16.17k   472.05    17.52k    68.70%\n  Latency Distribution\n     50%    4.46ms\n     75%   10.18ms\n     90%   13.01ms\n     99%   17.80ms\n  1608492 requests in 10.02s, 45.01GB read\nRequests/sec: 160583.24\nTransfer/sec:      4.49GB\n'})})]})}function l(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(p,{...n})}):p(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>c,x:()=>i});var t=s(6540);const a={},r=t.createContext(a);function c(n){const e=t.useContext(r);return t.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:c(n.components),t.createElement(r.Provider,{value:e},n.children)}}}]);