"use strict";(self.webpackChunkpingap=self.webpackChunkpingap||[]).push([[9329],{4732:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"plugins/mock","title":"Mock Service","description":"Return preset HTTP responses directly from Pingap without needing a backend service. A powerful tool for frontend development, API debugging, simulating errors, and load testing.","source":"@site/docs/plugins/mock.md","sourceDirName":"plugins","slug":"/plugins/mock","permalink":"/pingap-en/docs/plugins/mock","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/plugins/mock.md","tags":[],"version":"current","sidebarPosition":93,"frontMatter":{"sidebar_position":93,"title":"Mock Service","description":"Return preset HTTP responses directly from Pingap without needing a backend service. A powerful tool for frontend development, API debugging, simulating errors, and load testing."},"sidebar":"tutorialSidebar","previous":{"title":"Rate Limit","permalink":"/pingap-en/docs/plugins/limit"},"next":{"title":"Health Check (Ping)","permalink":"/pingap-en/docs/plugins/ping"}}');var i=t(4848),r=t(8453);const l={sidebar_position:93,title:"Mock Service",description:"Return preset HTTP responses directly from Pingap without needing a backend service. A powerful tool for frontend development, API debugging, simulating errors, and load testing."},o="Mock Service (Mocking) Plugin",c={},a=[{value:"Feature Introduction",id:"feature-introduction",level:2},{value:"Use Cases",id:"use-cases",level:2},{value:"Configuration Parameters",id:"configuration-parameters",level:2},{value:"Complete Example",id:"complete-example",level:2},{value:"1. Configure the Plugins",id:"1-configure-the-plugins",level:3},{value:"2. Apply the Plugins in Locations",id:"2-apply-the-plugins-in-locations",level:3},{value:"Access Effects",id:"access-effects",level:2}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"mock-service-mocking-plugin",children:"Mock Service (Mocking) Plugin"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"mock"})," plugin can turn Pingap into a configurable Mock Server. When a request hits a ",(0,i.jsx)(n.code,{children:"Location"})," where this plugin is applied, it will ",(0,i.jsx)(n.strong,{children:"intercept"})," the request and ",(0,i.jsx)(n.strong,{children:"directly return a response you have predefined"}),", without forwarding the request to any upstream service."]}),"\n",(0,i.jsx)(n.h2,{id:"feature-introduction",children:"Feature Introduction"}),"\n",(0,i.jsx)(n.p,{children:"The core feature of this plugin is the complete customization of the response. You can precisely control:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Status Code"}),": Return any status code, such as ",(0,i.jsx)(n.code,{children:"200 OK"}),", ",(0,i.jsx)(n.code,{children:"404 Not Found"}),", or ",(0,i.jsx)(n.code,{children:"503 Service Unavailable"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Headers"}),": Add any custom HTTP response headers, like ",(0,i.jsx)(n.code,{children:"Content-Type"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Body"}),": Return a response body with any content, whether it's JSON, HTML, or plain text."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Delay"}),": You can simulate network latency or a slow backend service by adding an artificial delay to the response."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Parallel Frontend and Backend Development"}),": When the frontend needs an API that the backend hasn't finished yet, you can use the Mock plugin to simulate successful or failed responses for that API, allowing frontend development to proceed without being blocked."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"API Documentation and Demos"}),": Provide interactive examples in your API documentation where users can directly call mock endpoints to see the request and response formats."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Simulating Error Conditions"}),": Easily simulate scenarios where the backend service fails (e.g., 5xx errors) to test whether the frontend application's error handling, retry, and circuit-breaker logic is robust."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Load and Stress Testing"}),": When testing clients or load balancers, use the Mock plugin to provide a stable backend with a controllable response time, eliminating interference from the performance fluctuations of a real backend."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Temporary Maintenance Page"}),": During backend service maintenance, you can quickly direct all requests for a specific ",(0,i.jsx)(n.code,{children:"Location"}),' to a mock response containing a "system under maintenance" message.']}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"configuration-parameters",children:"Configuration Parameters"}),"\n",(0,i.jsxs)(n.p,{children:["Configuration is done in the ",(0,i.jsx)(n.code,{children:"plugin.mock.toml"})," file."]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Parameter"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Type"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Required"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Default"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"status"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Integer"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"No"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"200"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"The HTTP status code of the mock response."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"data"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"No"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.em,{children:"(empty)"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"The content of the mock response body."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"headers"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Array of Strings"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"No"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"[]"})}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["A set of custom HTTP response headers, one per line, in the format ",(0,i.jsx)(n.code,{children:'"Key: Value"'}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"path"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"No"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.em,{children:"(empty)"})}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,i.jsx)(n.strong,{children:"Path Matching"}),". If set, the plugin will only take effect if the request path ",(0,i.jsx)(n.strong,{children:"exactly matches"})," this value. If left empty, it applies to all requests."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsx)(n.code,{children:"delay"})}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"No"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"-"}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["An artificial delay before returning the response. The format is a time string (e.g., ",(0,i.jsx)(n.code,{children:'"500ms"'}),", ",(0,i.jsx)(n.code,{children:'"2s"'}),")."]})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Goal"}),": During development, the frontend needs the ",(0,i.jsx)(n.code,{children:"/api/users/me"})," endpoint to return the current user's information, but the backend has not implemented it yet. At the same time, we need to simulate a ",(0,i.jsx)(n.code,{children:"/api/orders"})," endpoint that can randomly fail."]}),"\n",(0,i.jsx)(n.h3,{id:"1-configure-the-plugins",children:"1. Configure the Plugins"}),"\n",(0,i.jsx)(n.p,{children:"We need to create two separate Mock plugin instances."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsxs)(n.strong,{children:[(0,i.jsx)(n.code,{children:"plugin.mock-user-profile.toml"})," (Simulating a successful response)"]}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-toml",children:'# Always return 200 OK\nstatus = 200\n\n# Return fixed JSON data\ndata = \'\'\'\n{\n  "id": 123,\n  "username": "dev_user",\n  "email": "dev@example.com",\n  "roles": ["ADMIN", "USER"]\n}\n\'\'\'\n\n# Set the response content type to JSON\nheaders = [\n  "Content-Type: application/json; charset=utf-8",\n]\n\n# Simulate a 50ms network delay\ndelay = "50ms"\n'})}),"\n",(0,i.jsx)(n.p,{children:"plugin.mock-service-unavailable.toml (Simulating a failure response):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-toml",children:'# Return 503 Service Unavailable\nstatus = 503\n\n# Return a simple error message\ndata = "The order service is temporarily unavailable. Please try again later."\n\nheaders = [\n  "Content-Type: text/plain",\n  # Add a response header suggesting a retry\n  "Retry-After: 60", \n]\n'})}),"\n",(0,i.jsx)(n.h3,{id:"2-apply-the-plugins-in-locations",children:"2. Apply the Plugins in Locations"}),"\n",(0,i.jsx)(n.p,{children:"Now, we create two routing rules in location.toml to apply these two plugins respectively."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-toml",children:'# location.toml\n\n# --- Rule 1: Mock User Info Endpoint ---\n[locations.route-for-mock-user]\n# Exactly match this path\npath = "/api/users/me"\n# Note: The Mock plugin does not require an upstream\nplugins = [\n    "mock-user-profile",\n]\n\n# --- Rule 2: Mock Unstable Order Service ---\n[locations.route-for-mock-order]\npath = "/api/orders"\nplugins = [\n    "mock-service-unavailable",\n]\n'})}),"\n",(0,i.jsx)(n.h2,{id:"access-effects",children:"Access Effects"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Requesting User Information: ",(0,i.jsx)(n.code,{children:"GET /api/users/me"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Pingap will wait for 50ms, then immediately return a 200 OK response with the predefined user JSON data as the body. The request will not touch any backend service at all."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Requesting the Order Service: ",(0,i.jsx)(n.code,{children:"POST /api/orders"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Pingap will immediately return a 503 Service Unavailable response with a plain text message as the body and a suggestion for the client to retry after 60 seconds."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This approach allows the frontend team to develop and test completely independently, greatly improving the team's parallel collaboration efficiency."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>o});var s=t(6540);const i={},r=s.createContext(i);function l(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);