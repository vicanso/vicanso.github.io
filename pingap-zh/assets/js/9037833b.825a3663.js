"use strict";(self.webpackChunkpingap=self.webpackChunkpingap||[]).push([[7826],{7249:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>o,frontMatter:()=>r,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"plugins/limit","title":"\u8bf7\u6c42\u9650\u6d41 (Rate Limit)","description":"\u901a\u8fc7\u9650\u5236\u5355\u4f4d\u65f6\u95f4\u5185\u7684\u8bf7\u6c42\u901f\u7387\u6216\u5e76\u53d1\u8fde\u63a5\u6570\uff0c\u4fdd\u62a4\u60a8\u7684\u4e0a\u6e38\u670d\u52a1\u514d\u53d7\u6d41\u91cf\u6d2a\u5cf0\u548c\u6076\u610f\u653b\u51fb\u7684\u5f71\u54cd\uff0c\u786e\u4fdd\u670d\u52a1\u7684\u7a33\u5b9a\u6027\u548c\u516c\u5e73\u6027\u3002","source":"@site/docs/plugins/limit.md","sourceDirName":"plugins","slug":"/plugins/limit","permalink":"/pingap-zh/docs/plugins/limit","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/plugins/limit.md","tags":[],"version":"current","sidebarPosition":92,"frontMatter":{"sidebar_position":92,"title":"\u8bf7\u6c42\u9650\u6d41 (Rate Limit)","description":"\u901a\u8fc7\u9650\u5236\u5355\u4f4d\u65f6\u95f4\u5185\u7684\u8bf7\u6c42\u901f\u7387\u6216\u5e76\u53d1\u8fde\u63a5\u6570\uff0c\u4fdd\u62a4\u60a8\u7684\u4e0a\u6e38\u670d\u52a1\u514d\u53d7\u6d41\u91cf\u6d2a\u5cf0\u548c\u6076\u610f\u653b\u51fb\u7684\u5f71\u54cd\uff0c\u786e\u4fdd\u670d\u52a1\u7684\u7a33\u5b9a\u6027\u548c\u516c\u5e73\u6027\u3002"},"sidebar":"tutorialSidebar","previous":{"title":"API \u5bc6\u94a5\u8ba4\u8bc1 (Key Auth)","permalink":"/pingap-zh/docs/plugins/key-auth"},"next":{"title":"Mock \u670d\u52a1","permalink":"/pingap-zh/docs/plugins/mock"}}');var s=l(4848),t=l(8453);const r={sidebar_position:92,title:"\u8bf7\u6c42\u9650\u6d41 (Rate Limit)",description:"\u901a\u8fc7\u9650\u5236\u5355\u4f4d\u65f6\u95f4\u5185\u7684\u8bf7\u6c42\u901f\u7387\u6216\u5e76\u53d1\u8fde\u63a5\u6570\uff0c\u4fdd\u62a4\u60a8\u7684\u4e0a\u6e38\u670d\u52a1\u514d\u53d7\u6d41\u91cf\u6d2a\u5cf0\u548c\u6076\u610f\u653b\u51fb\u7684\u5f71\u54cd\uff0c\u786e\u4fdd\u670d\u52a1\u7684\u7a33\u5b9a\u6027\u548c\u516c\u5e73\u6027\u3002"},d="\u8bf7\u6c42\u9650\u6d41 (Limit) \u63d2\u4ef6",c={},h=[{value:"\u529f\u80fd\u7b80\u4ecb",id:"\u529f\u80fd\u7b80\u4ecb",level:2},{value:"\u9650\u5236\u6a21\u5f0f",id:"\u9650\u5236\u6a21\u5f0f",level:3},{value:"\u5ba2\u6237\u7aef\u8bc6\u522b\u65b9\u5f0f (<code>tag</code>)",id:"\u5ba2\u6237\u7aef\u8bc6\u522b\u65b9\u5f0f-tag",level:3},{value:"\u4f7f\u7528\u573a\u666f",id:"\u4f7f\u7528\u573a\u666f",level:2},{value:"\u914d\u7f6e\u53c2\u6570",id:"\u914d\u7f6e\u53c2\u6570",level:2},{value:"\u5b8c\u6574\u793a\u4f8b",id:"\u5b8c\u6574\u793a\u4f8b",level:2},{value:"\u793a\u4f8b 1\uff1a\u5bf9 API \u8fdb\u884c\u901f\u7387\u9650\u5236",id:"\u793a\u4f8b-1\u5bf9-api-\u8fdb\u884c\u901f\u7387\u9650\u5236",level:3},{value:"\u8bbf\u95ee\u6548\u679c",id:"\u8bbf\u95ee\u6548\u679c",level:3},{value:"\u793a\u4f8b 2\uff1a\u9650\u5236\u9ad8\u6d88\u8017\u63a5\u53e3\u7684\u5e76\u53d1\u6570",id:"\u793a\u4f8b-2\u9650\u5236\u9ad8\u6d88\u8017\u63a5\u53e3\u7684\u5e76\u53d1\u6570",level:3},{value:"\u8bbf\u95ee\u6548\u679c",id:"\u8bbf\u95ee\u6548\u679c-1",level:3}];function x(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\u8bf7\u6c42\u9650\u6d41-limit-\u63d2\u4ef6",children:"\u8bf7\u6c42\u9650\u6d41 (Limit) \u63d2\u4ef6"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"limit"})," \u63d2\u4ef6\u662f\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\u7684\u6d41\u91cf\u63a7\u5236\u63d2\u4ef6\uff0c\u5b83\u5141\u8bb8\u60a8\u5bf9\u901a\u8fc7 Pingap \u7684\u8bf7\u6c42\u8fdb\u884c\u7cbe\u786e\u7684\u901f\u7387\u548c\u5e76\u53d1\u9650\u5236\u3002\u8fd9\u662f\u4fdd\u62a4\u540e\u7aef\u670d\u52a1\u3001\u9632\u6b62\u8d44\u6e90\u6ee5\u7528\u548c\u62b5\u5fa1 DoS \u653b\u51fb\u7684\u5173\u952e\u5de5\u5177\u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"\u529f\u80fd\u7b80\u4ecb",children:"\u529f\u80fd\u7b80\u4ecb"}),"\n",(0,s.jsx)(n.p,{children:"\u8be5\u63d2\u4ef6\u63d0\u4f9b\u4e86\u4e24\u79cd\u6838\u5fc3\u7684\u9650\u5236\u6a21\u5f0f\uff0c\u5e76\u4e14\u53ef\u4ee5\u6839\u636e\u591a\u79cd\u5ba2\u6237\u7aef\u6807\u8bc6\u7b26\u8fdb\u884c\u7cbe\u7ec6\u5316\u63a7\u5236\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u9650\u5236\u6a21\u5f0f",children:"\u9650\u5236\u6a21\u5f0f"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u901f\u7387\u9650\u5236 (Rate Limiting)"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5de5\u4f5c\u539f\u7406"}),": \u9650\u5236\u5728",(0,s.jsx)(n.strong,{children:"\u7ed9\u5b9a\u7684\u65f6\u95f4\u7a97\u53e3\u5185"}),"\uff0c\u67d0\u4e2a\u6807\u8bc6\u7b26\uff08\u5982 IP \u5730\u5740\uff09\u5141\u8bb8\u901a\u8fc7\u7684\u8bf7\u6c42\u603b\u6570\u3002\u4f8b\u5982\uff0c\u201c\u6bcf\u4e2a IP \u6bcf\u5206\u949f\u6700\u591a 100 \u4e2a\u8bf7\u6c42\u201d\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u6a21\u5f0f\u540d\u79f0"}),": ",(0,s.jsx)(n.code,{children:"rate"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5e76\u53d1\u9650\u5236 (Concurrency Limiting)"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5de5\u4f5c\u539f\u7406"}),": \u9650\u5236\u5728",(0,s.jsx)(n.strong,{children:"\u540c\u4e00\u65f6\u523b"}),"\uff0c\u67d0\u4e2a\u6807\u8bc6\u7b26\uff08\u5982\u7528\u6237 ID\uff09\u5141\u8bb8\u5b58\u5728\u7684\u5e76\u53d1\uff08\u672a\u5b8c\u6210\u7684\uff09\u8bf7\u6c42\u6570\u3002\u4f8b\u5982\uff0c\u201c\u6bcf\u4e2a\u7528\u6237\u6700\u591a\u540c\u65f6\u8fdb\u884c 5 \u4e2a\u8bf7\u6c42\u201d\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u6a21\u5f0f\u540d\u79f0"}),": ",(0,s.jsx)(n.code,{children:"inflight"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"\u5ba2\u6237\u7aef\u8bc6\u522b\u65b9\u5f0f-tag",children:["\u5ba2\u6237\u7aef\u8bc6\u522b\u65b9\u5f0f (",(0,s.jsx)(n.code,{children:"tag"}),")"]}),"\n",(0,s.jsx)(n.p,{children:"\u60a8\u53ef\u4ee5\u914d\u7f6e\u63d2\u4ef6\u901a\u8fc7\u4ee5\u4e0b\u56db\u79cd\u65b9\u5f0f\u6765\u8bc6\u522b\u548c\u533a\u5206\u5ba2\u6237\u7aef\uff0c\u4ece\u800c\u5b9e\u73b0\u9488\u5bf9\u6027\u7684\u9650\u6d41\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["IP \u5730\u5740 (",(0,s.jsx)(n.code,{children:"ip"}),")"]}),": \u57fa\u4e8e\u5ba2\u6237\u7aef\u7684\u771f\u5b9e IP \u5730\u5740\u8fdb\u884c\u9650\u5236\u3002\u8fd9\u662f\u6700\u901a\u7528\u7684\u65b9\u5f0f\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["HTTP \u8bf7\u6c42\u5934 (",(0,s.jsx)(n.code,{children:"header"}),")"]}),": \u57fa\u4e8e\u6307\u5b9a\u7684\u8bf7\u6c42\u5934\u7684\u503c\u8fdb\u884c\u9650\u5236\uff08\u4f8b\u5982\uff0c",(0,s.jsx)(n.code,{children:"X-User-ID"}),"\uff09\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["Cookie (",(0,s.jsx)(n.code,{children:"cookie"}),")"]}),": \u57fa\u4e8e\u6307\u5b9a\u7684 Cookie \u503c\u8fdb\u884c\u9650\u5236\uff08\u4f8b\u5982\uff0c\u4f1a\u8bdd ID ",(0,s.jsx)(n.code,{children:"session_id"}),"\uff09\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["URL \u67e5\u8be2\u53c2\u6570 (",(0,s.jsx)(n.code,{children:"query"}),")"]}),": \u57fa\u4e8e\u6307\u5b9a\u7684 URL \u67e5\u8be2\u53c2\u6570\u503c\u8fdb\u884c\u9650\u5236\uff08\u4f8b\u5982\uff0c",(0,s.jsx)(n.code,{children:"api_key"}),"\uff09\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u4f7f\u7528\u573a\u666f",children:"\u4f7f\u7528\u573a\u666f"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u4fdd\u62a4\u767b\u5f55\u63a5\u53e3"}),": \u5bf9\u767b\u5f55 API \u6309 ",(0,s.jsx)(n.strong,{children:"IP"})," \u8fdb\u884c",(0,s.jsx)(n.strong,{children:"\u901f\u7387\u9650\u5236"}),"\uff0c\u4ee5\u9632\u5fa1\u5bc6\u7801\u7206\u7834\u653b\u51fb\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u9632\u6b62\u722c\u866b\u6ee5\u7528"}),": \u5bf9\u722c\u866b\u6d41\u91cf\u8f83\u5927\u7684\u63a5\u53e3\uff0c\u6309 ",(0,s.jsx)(n.strong,{children:"IP"})," \u6216 ",(0,s.jsx)(n.strong,{children:"User-Agent"})," (\u901a\u8fc7 ",(0,s.jsx)(n.code,{children:"header"})," tag) \u8fdb\u884c",(0,s.jsx)(n.strong,{children:"\u901f\u7387\u9650\u5236"}),"\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u4fdd\u8bc1\u516c\u5e73\u4f7f\u7528"}),": \u5bf9\u516c\u5171 API\uff0c\u6309 ",(0,s.jsx)(n.strong,{children:"API Key"})," (\u901a\u8fc7 ",(0,s.jsx)(n.code,{children:"header"})," \u6216 ",(0,s.jsx)(n.code,{children:"query"})," tag) \u8fdb\u884c",(0,s.jsx)(n.strong,{children:"\u901f\u7387\u9650\u5236"}),"\uff0c\u786e\u4fdd\u6bcf\u4e2a\u7528\u6237\u90fd\u5728\u5176\u914d\u989d\u5185\u4f7f\u7528\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u4fdd\u62a4\u6602\u8d35\u7684\u64cd\u4f5c"}),": \u5bf9\u4e8e\u6d88\u8017\u5927\u91cf\u8ba1\u7b97\u8d44\u6e90\u6216\u6570\u636e\u5e93\u8d44\u6e90\u7684\u8bf7\u6c42\uff08\u5982\u751f\u6210\u62a5\u8868\uff09\uff0c\u6309 ",(0,s.jsx)(n.strong,{children:"\u7528\u6237 ID"})," (\u901a\u8fc7 ",(0,s.jsx)(n.code,{children:"cookie"})," \u6216 ",(0,s.jsx)(n.code,{children:"header"})," tag) \u8fdb\u884c",(0,s.jsx)(n.strong,{children:"\u5e76\u53d1\u9650\u5236"}),"\uff0c\u9632\u6b62\u5355\u4e2a\u7528\u6237\u62d6\u57ae\u7cfb\u7edf\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5168\u5c40\u5e76\u53d1\u4fdd\u62a4"}),": \u9650\u5236\u6574\u4e2a\u670d\u52a1\u7684\u603b",(0,s.jsx)(n.strong,{children:"\u5e76\u53d1\u8fde\u63a5\u6570"}),"\uff0c\u9632\u6b62\u6d41\u91cf\u6d2a\u5cf0\u5bfc\u81f4\u670d\u52a1\u96ea\u5d29\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u914d\u7f6e\u53c2\u6570",children:"\u914d\u7f6e\u53c2\u6570"}),"\n",(0,s.jsxs)(n.p,{children:["\u5728 ",(0,s.jsx)(n.code,{children:"plugin.limit.toml"})," \u6587\u4ef6\u4e2d\u8fdb\u884c\u914d\u7f6e\u3002"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u53c2\u6570"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u7c7b\u578b"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u662f\u5426\u5fc5\u9700"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u9ed8\u8ba4\u503c"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"\u8bf4\u660e"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"type"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u5426"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:'"rate"'})}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:["\u9650\u5236\u6a21\u5f0f\u3002\u53ef\u9009\u503c\u4e3a ",(0,s.jsx)(n.code,{children:'"rate"'})," (\u901f\u7387\u9650\u5236) \u6216 ",(0,s.jsx)(n.code,{children:'"inflight"'})," (\u5e76\u53d1\u9650\u5236)\u3002"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"max"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Integer"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.strong,{children:"\u662f"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,s.jsx)(n.strong,{children:"\uff08\u5fc5\u9700\uff09"})," \u5141\u8bb8\u7684\u6700\u5927\u8bf7\u6c42\u6570\u3002\u5728 ",(0,s.jsx)(n.code,{children:"rate"})," \u6a21\u5f0f\u4e0b\uff0c\u6307\u65f6\u95f4\u7a97\u53e3\u5185\u7684\u8bf7\u6c42\u6570\uff1b\u5728 ",(0,s.jsx)(n.code,{children:"inflight"})," \u6a21\u5f0f\u4e0b\uff0c\u6307\u5e76\u53d1\u8bf7\u6c42\u6570\u3002"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"interval"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,s.jsx)(n.code,{children:"rate"})," \u6a21\u5f0f\u4e0b",(0,s.jsx)(n.strong,{children:"\u662f"})]}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:'"10s"'})}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:["\u65f6\u95f4\u7a97\u53e3\u5927\u5c0f\uff0c\u4ec5\u7528\u4e8e ",(0,s.jsx)(n.code,{children:"rate"})," \u6a21\u5f0f\u3002\u683c\u5f0f\u4e3a\u65f6\u95f4\u5b57\u7b26\u4e32\uff08\u5982 ",(0,s.jsx)(n.code,{children:'"1m"'}),", ",(0,s.jsx)(n.code,{children:'"1h"'}),"\uff09\u3002"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"tag"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"\u5426"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:'"ip"'})}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:["\u5ba2\u6237\u7aef\u8bc6\u522b\u65b9\u5f0f\u3002\u53ef\u9009\u503c\u4e3a ",(0,s.jsx)(n.code,{children:'"ip"'}),", ",(0,s.jsx)(n.code,{children:'"header"'}),", ",(0,s.jsx)(n.code,{children:'"cookie"'}),", ",(0,s.jsx)(n.code,{children:'"query"'}),"\u3002"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.code,{children:"key"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"String"}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:[(0,s.jsx)(n.code,{children:"tag"})," \u975e ",(0,s.jsx)(n.code,{children:"ip"})," \u65f6",(0,s.jsx)(n.strong,{children:"\u662f"})]}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"-"}),(0,s.jsxs)(n.td,{style:{textAlign:"left"},children:["\u5f53 ",(0,s.jsx)(n.code,{children:"tag"})," \u4e3a ",(0,s.jsx)(n.code,{children:"header"}),", ",(0,s.jsx)(n.code,{children:"cookie"}),", \u6216 ",(0,s.jsx)(n.code,{children:"query"})," \u65f6\uff0c\u6307\u5b9a\u8981\u8bfb\u53d6\u7684",(0,s.jsx)(n.strong,{children:"\u952e\u540d"}),"\u3002"]})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"\u5b8c\u6574\u793a\u4f8b",children:"\u5b8c\u6574\u793a\u4f8b"}),"\n",(0,s.jsx)(n.h3,{id:"\u793a\u4f8b-1\u5bf9-api-\u8fdb\u884c\u901f\u7387\u9650\u5236",children:"\u793a\u4f8b 1\uff1a\u5bf9 API \u8fdb\u884c\u901f\u7387\u9650\u5236"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u76ee\u6807"}),"\uff1a\u4fdd\u62a4\u6211\u4eec\u7684\u516c\u5171 API\uff0c\u9650\u5236\u6bcf\u4e2a API Key \u6bcf\u5206\u949f\u6700\u591a\u53ea\u80fd\u53d1\u8d77 100 \u6b21\u8bf7\u6c42\u3002API Key \u901a\u8fc7 ",(0,s.jsx)(n.code,{children:"X-Api-Key"})," \u8bf7\u6c42\u5934\u4f20\u9012\u3002"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["\u914d\u7f6e\u63d2\u4ef6 (",(0,s.jsx)(n.code,{children:"plugin.limit-api-rate.toml"}),")"]}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",children:'# \u6a21\u5f0f\uff1a\u901f\u7387\u9650\u5236\ntype = "rate"\n\n# \u9650\u5236\uff1a\u6bcf\u5206\u949f 100 \u6b21\nmax = 100\ninterval = "1m"\n\n# \u8bc6\u522b\u65b9\u5f0f\uff1a\u8bf7\u6c42\u5934\ntag = "header"\nkey = "X-Api-Key"\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["\u5728 Location \u4e2d\u5e94\u7528\u63d2\u4ef6 (",(0,s.jsx)(n.code,{children:"location.toml"}),")"]}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",children:'# location.toml\n[[server.locations]]\npath = "/api/public/"\nupstream = "public-api-backend"\nplugins = [\n    "limit-api-rate",\n]\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u8bbf\u95ee\u6548\u679c",children:"\u8bbf\u95ee\u6548\u679c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u5bf9\u4e8e\u643a\u5e26 ",(0,s.jsx)(n.code,{children:"X-Api-Key: key-A"})," \u7684\u5ba2\u6237\u7aef\uff0c\u5728\u4e00\u5206\u949f\u5185\u53d1\u8d77\u7684\u524d 100 \u4e2a\u8bf7\u6c42\u5c06\u6b63\u5e38\u901a\u8fc7\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u4ece\u7b2c 101 \u4e2a\u8bf7\u6c42\u5f00\u59cb\uff0c\u8be5\u5ba2\u6237\u7aef\u5c06\u6536\u5230 ",(0,s.jsx)(n.code,{children:"429 Too Many Requests"})," \u54cd\u5e94\uff0c\u76f4\u5230\u5f53\u524d\u65f6\u95f4\u7a97\u53e3\u7ed3\u675f\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u643a\u5e26 ",(0,s.jsx)(n.code,{children:"X-Api-Key: key-B"})," \u7684\u53e6\u4e00\u4e2a\u5ba2\u6237\u7aef\u5c06\u62e5\u6709\u81ea\u5df1\u72ec\u7acb\u7684\u8ba1\u6570\u5668\uff0c\u4e0d\u53d7\u5f71\u54cd\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u793a\u4f8b-2\u9650\u5236\u9ad8\u6d88\u8017\u63a5\u53e3\u7684\u5e76\u53d1\u6570",children:"\u793a\u4f8b 2\uff1a\u9650\u5236\u9ad8\u6d88\u8017\u63a5\u53e3\u7684\u5e76\u53d1\u6570"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u76ee\u6807"}),"\uff1a",(0,s.jsx)(n.code,{children:"/api/reports"})," \u662f\u4e00\u4e2a\u975e\u5e38\u6d88\u8017\u8d44\u6e90\u7684\u62a5\u8868\u751f\u6210\u63a5\u53e3\u3002\u6211\u4eec\u5e0c\u671b\u9650\u5236\u6bcf\u4e2a\u767b\u5f55\u7528\u6237\uff08\u901a\u8fc7 ",(0,s.jsx)(n.code,{children:"session_id"})," Cookie \u8bc6\u522b\uff09\u540c\u65f6\u53ea\u80fd\u751f\u6210 1 \u4e2a\u62a5\u8868\u3002"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["\u914d\u7f6e\u63d2\u4ef6 (",(0,s.jsx)(n.code,{children:"plugin.limit-report-inflight.toml"}),")"]}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",children:'# \u6a21\u5f0f\uff1a\u5e76\u53d1\u9650\u5236\ntype = "inflight"\n\n# \u9650\u5236\uff1a\u6bcf\u4e2a\u7528\u6237\u5e76\u53d1\u4e3a 1\nmax = 1\n\n# \u8bc6\u522b\u65b9\u5f0f\uff1aCookie\ntag = "cookie"\nkey = "session_id"\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsxs)(n.strong,{children:["\u5728 Location \u4e2d\u5e94\u7528\u63d2\u4ef6 (",(0,s.jsx)(n.code,{children:"location.toml"}),")"]}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-toml",children:'# location.toml\n[locations.route-for-my-app]\npath = "/api/reports"\nupstream = "report-generator-backend"\nplugins = [\n    "limit-report-inflight",\n]\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u8bbf\u95ee\u6548\u679c-1",children:"\u8bbf\u95ee\u6548\u679c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u62e5\u6709 ",(0,s.jsx)(n.code,{children:"session_id=abc"})," \u7684\u7528\u6237\u53d1\u8d77\u4e86\u7b2c\u4e00\u4e2a\u62a5\u8868\u751f\u6210\u8bf7\u6c42\uff0c\u8be5\u8bf7\u6c42\u6b63\u5e38\u6267\u884c\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:["\u5728\u7b2c\u4e00\u4e2a\u8bf7\u6c42\u5b8c\u6210",(0,s.jsx)(n.strong,{children:"\u4e4b\u524d"}),"\uff0c\u8be5\u7528\u6237\u53c8\u53d1\u8d77\u4e86\u7b2c\u4e8c\u4e2a\u62a5\u8868\u751f\u6210\u8bf7\u6c42\u3002\u6b64\u8bf7\u6c42\u5c06\u88ab\u63d2\u4ef6\u62e6\u622a\uff0c\u5e76\u7acb\u5373\u6536\u5230 ",(0,s.jsx)(n.code,{children:"429 Too Many Requests"})," \u54cd\u5e94\u3002"]}),"\n",(0,s.jsx)(n.li,{children:"\u5f53\u7b2c\u4e00\u4e2a\u8bf7\u6c42\u5b8c\u6210\u540e\uff0c\u8be5\u7528\u6237\u624d\u80fd\u518d\u6b21\u53d1\u8d77\u65b0\u7684\u8bf7\u6c42\u3002"}),"\n"]})]})}function o(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(x,{...e})}):x(e)}},8453:(e,n,l)=>{l.d(n,{R:()=>r,x:()=>d});var i=l(6540);const s={},t=i.createContext(s);function r(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);